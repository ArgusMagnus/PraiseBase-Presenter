<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="88143924-1c44-4a5f-8dab-9b12d5c02979" 
           Name="$(var.PraiseBase_Presenter.ProjectName)" 
           Language="1033" 
           Version="1.0.0.0" 
           Manufacturer="PraiseBase Langenthal" 
           UpgradeCode="ae6f4ec6-c8e4-4ce0-8db8-0a1cac2ac529">
    <Package InstallerVersion="200" Compressed="yes" />

    <Media Id="1" Cabinet="media1.cab" EmbedCab="yes" />
    <Icon Id="icon.ico" SourceFile="$(var.PraiseBase_Presenter.ProjectDir)Resources\Application\Computer.ico"/>
    <Property Id="ARPPRODUCTICON" Value="icon.ico" />

    <UIRef Id="WixUI_Minimal"/>
    <WixVariable Id="WixUILicenseRtf" Value="$(var.PraiseBase_Presenter.ProjectDir)Resources\Doc\License.rtf" />
    <!-- Source: http://www.flickr.com/photos/malcorp/3703556108/ -->
    <WixVariable Id="WixUIDialogBmp" Value="Resources\Background.bmp" />
    <WixVariable Id="WixUIBannerBmp" Value="Resources\Banner.bmp" />

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="INSTALLLOCATION" Name="$(var.PraiseBase_Presenter.ProjectName)">
          <Component Id="ProductComponent" Guid="973a7a66-c64c-42c4-9bb0-19ed07c65f57">
            <File Id="MyApplicationFile" 
                  Name="$(var.PraiseBase_Presenter.TargetFileName)" 
                  Source="$(var.PraiseBase_Presenter.TargetPath)"
                  KeyPath="yes" />
          </Component>
          <Component Id="LicenseRtf" Guid="96dc79f8-2344-4610-a167-9b09ee501509">
            <File Id="License.rtf" 
                  Source="$(var.PraiseBase_Presenter.ProjectDir)Resources\Doc\License.rtf" 
                  KeyPath="yes"/>
          </Component>
          <Component Id="LicenseTxt" Guid="626b9fa0-0c14-4d4d-804a-911a454e76d7">
            <File Id="License.txt"
                  Source="$(var.PraiseBase_Presenter.ProjectDir)Resources\Doc\License.txt"
                  KeyPath="yes"/>
          </Component>
        </Directory>
      </Directory>

      <Directory Id="ProgramMenuFolder" Name="Programs">
        <Component Id="ApplicationStartMenuShortcut" Guid="A07A731E-7E98-44CE-B049-C477CC0A2B00">
          <Shortcut Id="ApplicationStartMenuShortcut"
                    Name="$(var.PraiseBase_Presenter.ProjectName)"
                    Target="[INSTALLLOCATION]$(var.PraiseBase_Presenter.TargetFileName)"
                    WorkingDirectory="INSTALLLOCATION"/>            
          <RemoveFolder Id='ProgramMenuDir' On='uninstall' />
          <RegistryValue Root='HKCU' Key='Software\[Manufacturer]\[ProductName]' Type='string' Value='' KeyPath='yes' />
        </Component>
      </Directory>

      <Directory Id="DesktopFolder" Name="Desktop">
        <Component Id="DesktopShortcut" Guid="d690bbf6-896d-44cb-86d0-9f42ece563cb">
          <Shortcut Id="DesktopShortcut"
                    Name="$(var.PraiseBase_Presenter.ProjectName)"
                    Target="[INSTALLLOCATION]$(var.PraiseBase_Presenter.TargetFileName)"
                    WorkingDirectory="INSTALLLOCATION"/>
          <RemoveFolder Id='DesktopShortcut' On='uninstall' />
          <RegistryValue Root='HKCU' Key='Software\[Manufacturer]\[ProductName]' Type='string' Value='' KeyPath='yes' />
        </Component>
      </Directory>
      
    </Directory>

    <Feature Id="ProductFeature" 
             Title="$(var.PraiseBase_Presenter.ProjectName)" 
             Level="1">
      <ComponentRef Id="ProductComponent" />
      <ComponentRef Id="LicenseRtf" />
      <ComponentRef Id="LicenseTxt" />
      <ComponentRef Id="ApplicationStartMenuShortcut" />
      <ComponentRef Id="DesktopShortcut" />
      <!-- Note: The following ComponentGroupRef is required to pull in generated authoring from project references. -->
      <ComponentGroupRef Id="Product.Generated" />
    </Feature>
  </Product>
</Wix>
